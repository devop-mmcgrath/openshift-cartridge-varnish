#!/bin/bash -eu

source $OPENSHIFT_CARTRIDGE_SDK_BASH
CALL=$1
function start {
    ~/varnish/usr/sbin/varnishd -f $OPENSHIFT_REPO_DIR/default.vcl -n ~/varnish/var/lib/varnish -P ~/varnish/var/run/varnish.pid -u "$OPENSHIFT_GEAR_UUID" -a "$OPENSHIFT_VARNISH_IP":"$OPENSHIFT_VARNISH_PORT"
 #-T 127.3.75.131:8080
}

function stop {
    killall varnishd
}

function restart {
  stop
  start
}

function not_implemented {
  echo "$CALL: not implemented"
}

case "$1" in
  start)         start ;;
  stop)          stop ;;
  restart)       restart ;;
  status)        not_implemented ;;
  reload)        not_implemented ;;
  tidy)          not_implemented ;;
  pre-build)     not_implemented ;;
  build)         not_implemented ;;
  deploy)        not_implemented ;;
  post-deploy)   not_implemented ;;
  pre-snapshot)  not_implemented ;;
  post-snapshot) not_implemented ;;
  pre-restore)   not_implemented ;;
  post-restore)  not_implemented ;;
  pre-receive)   not_implemented ;;
  update-configuration) not_implemented ;;
  *)           exit 0
esac

exit 0
